# 스프링 시큐리티
스프링 부트 시큐리티에서 가장 중요한 개념은 인증(authentication)과 권한부여(authorization)이다.
* 인증
    * 사용자(클라이언트)가 애플리케이션의 특정 동작에 관하여 허락(인증)된 사용자인지 확인하는 절차
        * 웹사이트 로그인과 같은 경우
* 권한 부여
    * 데이터나 프로그램 등의 특정 자원이나 서비스에 접근할 수 있는 권한.
        * 관리자/사용자 별 권한의 차이 등

## 인증 방식
* 크리덴셜(credential) 기반 인증 방식
    * 사용자명(principle)과 비밀번호(credential)로 인증하는 방식
* 이중 인증 방식
    * OTP와 같은 추가적인 인증 방식을 도입해 한번에 2가지 방법으로 인증하는 방식
* OAuth2 인증 방식
    * 소셜 미디어를 사용해 편리하게 인증하는 방식.

## OAuth2
OAuth2는 토큰을 사용한 범용적인 방법의 인증을 제공하는 표준 인증 프로토콜이다.
### OAuth2에서 제공하는 승인 타입
* 권한 부여 코드 승인 타입(Authorization Code Grant Type)
    * 클라이언트가 다른 사용자 대신 특정 리소스에 접근을 요청할 때 사용됨.
    * 리소스 접근을 위한 사용자명과 비밀번호, 권한 서버에 요청에서 받은 권한 코드를 함께 활용하여 리소스에 대한 액세스 토큰을 받으면 이를 인증에 이용하는 방식.
* 암시적 승인 타입(Implicit Grant Type)
    * 권한 부여 코드 승인 타입과 다르게 권한 코드 교환 단계 없이 액세스 토큰을 즉시 반환받아 이를 인증에 이용하는 방식.
* 리소스 소유자 암호 자격 증명 승인 타입(Resource Owner Password Credentials Grant Type)
    * 클라이언트가 암호를 사용하여 액세스 토큰에 대한 사용자의 자격 증명을 교환하는 방식
* 클라이언트 자격 증명 승인 타입(Client Credentials Grant Type)
    * 클라이언트가 컨텍스트 외부에서 액세스 토큰을 얻어 특정 리소스에 접근을 요청할 때 사용하는 방식

참고로 카카오, 구글 등의 소셜 미디어들이 웹 서버 형태의 클라이언트를 지원하는 데에는 권한 부여 코드 승인 타입을 사용하여 장기 액세스 토큰을 통한 사용자 인정을 처리한다.
![](https://i.imgur.com/lUAcGJe.png)
1. 클라이언트가 파라미터로 클라이언트 ID, 리다이렉트 URI, 응답 타입을 code로 지정하여 권한 서버에 전달. 정상적으로 인증이 되면 권한 부여 코드를 클라이언트에 보낸다.(응답 타입은 code, token이 사용 가능. 응답 타입이 token일 때는 암시적 승인 타입에 해당한다.)
2. 성공적으로 권한 부여 코드를 받은 클라이언트는 권한 부여 코드를 사용하여 액세스 토큰을 권한 서버에 추가로 요청. 이 때 필요한 파라미터는 클라이언트 ID, 클라이언트 비밀번호, 리다이렉트 URI, 인증 타입이다.
3. 응답받은 액세스 토큰을 사용하여 리소스 서버에 사용자의 데이터를 요청.

위의 프로세스에서 알 수 있듯, OAuth2방식은 그냥[아이디/비번]으로 로그인 하는 방법과는 다르게 서버에 3번 요청하게 된다.
그래도 이미 존재하는 소셜 미디어 계정을 사용하여 인증하기 때문에 사용자 입장에서 더 편하다.

* 리소스 주인
    * 인증이 필요한 사용자
* 클라이언트
    * 웹사이트
* 권한 서버
    * 카톡/구글 등
* 리소스서버
    * 카톡/구글 등

